@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor HttpContextAccessor

@{
    var listaProdotti = HttpContextAccessor.HttpContext.Session.Get<List<GranBazar.Models.Prodotto>>("prodottiCarrello");
    var listaQuantita = HttpContextAccessor.HttpContext.Session.Get<List<int>>("quantitaPerProdotto");
    var utenteLoggato = HttpContextAccessor.HttpContext.Session.Get<GranBazar.Models.Utente>("utenteLoggato");
    var numeroDiElementiInCarrello = HttpContextAccessor.HttpContext.Session.GetInt32("numeroElementiInCarrello");
    string ruolo = "";
    if (utenteLoggato != null) { ruolo = utenteLoggato.Ruolo; };
}

<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="/">Home Page</a>
        </div>

        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li>@Html.ActionLink("Prodotti","ElencoProdotti","Prodotti")</li>
                @if (ruolo.Equals("User")){
                    <li>@Html.ActionLink("Area Riservata", "AreaRiservataUser", "Account")</li>}
                else if (ruolo.Equals("Admin")){
                    <li>@Html.ActionLink("Elenco utenti", "ElencoUtenti", "Account")</li>
                    <li>@Html.ActionLink("Elenco ordini", "ElencoOrdini", "Account")</li>
                    <li>@Html.ActionLink("Catalogo prodotti", "CatalogoProdotti", "Account")</li>}
            </ul>

        <div class="container-fluid">
            <div class="row">
                <form class="col-xs-@(ruolo.Equals("User") ? "6" : ruolo.Equals("Admin") ? "4":"8")" style="top:9px;left:24px" method="get" action="/Ricerca/Index">
                    <div class="input-group">
                        <input type="text" class="form-control" name="search" placeholder="Cerca.." id="search">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                        </span>
                   </div>
                </form>
                <ul class="nav navbar-nav navbar-right">   
                    <li>@Html.ActionLink("Carrello", "Index", "Carrello")</li>
                    <!--bisogna migliorare questa parte, renderla più carina
                    <li style="top:16px;" ><img src="~/img/cart_icon.png" /></li>-->
                    <li style="top:16px;">@if (numeroDiElementiInCarrello != null) { <div>-> (@numeroDiElementiInCarrello)</div> } </li>
                    @if (ruolo.Equals("")){<li>@Html.ActionLink("Login", "Login", "Account", new { url = Context.Request.Path + Context.Request.QueryString })</li> }
                    else{<li>@Html.ActionLink("Logout", "Logout", "Account")</li> }
                </ul>
            </div>
        </div>   
        </div>
    </div>
</nav>